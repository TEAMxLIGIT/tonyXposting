# broadcast.py

import asyncio
from pyrogram import Client
from pyrogram.types import Message
from config import api_id, api_hash, bot_token, session_name

async def broadcast_message(app: Client, message: Message):
    # Extracting the reply message if it exists
    reply_message = message.reply_to_message

    # Broadcast the reply message or the original message with media to all groups and chats
    dialogs = await app.get_dialogs()
    for dialog in dialogs:
        if dialog.chat.type in ["group", "supergroup"]:
            await message.reply_chat_action("typing")
            await asyncio.sleep(5)  # Adjust the time delay if needed

            if reply_message:
                await app.send_message(dialog.chat.id, reply_message.text)
            elif message.text:
                await app.send_message(dialog.chat.id, message.text)